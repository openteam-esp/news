<% if collection.any? %>
  <ul class='item_list'>
    <% collection.each do | task | %>
      <li>
        <div class="title floatl">
          <!-- #TODO remove this stinky code-->
          <% if task.is_a?(Subtask) %>
            <%= link_to task.truncated_description, entry_path(task.entry) %>
          <% else %>
            <%= link_to task.class.model_name.human, entry_path(task.entry) %>
          <% end %>
        </div>

        <div class="entry_title">
          <%= composed_title(task.entry) %>
        </div>


        <div class="state <%= task.state %>">
          <%= I18n.t "state_machine.task.state.#{task.state}" %>
          <%= render :partial => 'followings/actions', :locals => {:task => task} if task.respond_to?(:fresh?) && task.fresh? %>
        </div>

        <div class="participants">
          <%= task.initiator %>
        </div>

        <div class="time_ago">
          <%= time_ago_in_words(task.created_at) %> назад
        </div>

        <%= render :partial => 'tasks/actions', :locals => {:task => task} if task.respond_to?(:fresh?) && task.fresh? %>
      </li>
    <% end %>
  </ul>
  <%= paginate collection %>
<% else %>
  <h2 class='empty'><%= t('no_any_tasks') %></h2>
<% end %>
